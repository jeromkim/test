# ë””ë ‰í† ë¦¬ ë° ê¸°ëŠ¥ ë¶„ë¦¬ ì›ì¹™

## ğŸ—ï¸ ë””ë ‰í† ë¦¬ ë¶„ë¦¬ ê¸°ì¤€

### 1. **ë ˆì´ì–´ë³„ ë¶„ë¦¬ (Layered Architecture)**
```
src/
â”œâ”€â”€ adapters/          # ì™¸ë¶€ ì¸í„°í˜ì´ìŠ¤ (Controller)
â”œâ”€â”€ services/          # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (Service)
â”œâ”€â”€ tools/            # ì™¸ë¶€ ë„êµ¬ ì—°ë™ (Tools)
â”œâ”€â”€ utils/            # ê³µí†µ ìœ í‹¸ë¦¬í‹° (Utils)
â”œâ”€â”€ config/           # ì„¤ì • ê´€ë¦¬
â””â”€â”€ prompts/          # í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
```

**ê¸°ì¤€**: ì±…ì„ê³¼ ì—­í• ì— ë”°ë¥¸ ê³„ì¸µ êµ¬ì¡°

### 2. **ë„ë©”ì¸ë³„ ë¶„ë¦¬ (Domain-Driven Design)**
```
src/
â”œâ”€â”€ auth/             # ì¸ì¦ ë„ë©”ì¸
â”œâ”€â”€ chat/             # ì±„íŒ… ë„ë©”ì¸
â”œâ”€â”€ knowledge/        # ì§€ì‹ ê²€ìƒ‰ ë„ë©”ì¸
â”œâ”€â”€ history/          # íˆìŠ¤í† ë¦¬ ë„ë©”ì¸
â””â”€â”€ shared/           # ê³µí†µ ë„ë©”ì¸
```

**ê¸°ì¤€**: ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ê³¼ ê´€ì‹¬ì‚¬ ë¶„ë¦¬

### 3. **ê¸°ëŠ¥ë³„ ë¶„ë¦¬ (Feature-Based)**
```
src/
â”œâ”€â”€ authentication/   # ì¸ì¦ ê¸°ëŠ¥
â”œâ”€â”€ conversation/     # ëŒ€í™” ê¸°ëŠ¥
â”œâ”€â”€ document_search/  # ë¬¸ì„œ ê²€ìƒ‰ ê¸°ëŠ¥
â”œâ”€â”€ user_feedback/    # í”¼ë“œë°± ê¸°ëŠ¥
â””â”€â”€ common/          # ê³µí†µ ê¸°ëŠ¥
```

**ê¸°ì¤€**: ì‚¬ìš©ì ê¸°ëŠ¥ ë‹¨ìœ„ë¡œ ë¶„ë¦¬

## ğŸ”§ ê¸°ëŠ¥ ë¶„ë¦¬ ê¸°ì¤€

### 1. **ë‹¨ì¼ ì±…ì„ ì›ì¹™ (SRP)**
```python
# âŒ ì˜ëª»ëœ ì˜ˆ: í•˜ë‚˜ì˜ í´ë˜ìŠ¤ê°€ ì—¬ëŸ¬ ì±…ì„
class ChatService:
    def authenticate_user(self):     # ì¸ì¦ ì±…ì„
        pass
    def generate_response(self):     # ì‘ë‹µ ìƒì„± ì±…ì„
        pass
    def save_history(self):          # íˆìŠ¤í† ë¦¬ ì €ì¥ ì±…ì„
        pass

# âœ… ì˜¬ë°”ë¥¸ ì˜ˆ: ì±…ì„ë³„ ë¶„ë¦¬
class AuthService:
    def authenticate_user(self):
        pass

class ChatService:
    def generate_response(self):
        pass

class HistoryService:
    def save_history(self):
        pass
```

### 2. **ê´€ì‹¬ì‚¬ ë¶„ë¦¬ (Separation of Concerns)**
```python
# í˜„ì¬ í”„ë¡œì íŠ¸ ì ìš© ì˜ˆì‹œ

# ì¸ì¦ ê´€ì‹¬ì‚¬
src/auth.py                    # JWT í† í° ê²€ì¦

# ì±„íŒ… ê´€ì‹¬ì‚¬  
src/services/chat_service.py   # LLM í˜¸ì¶œ, ì‘ë‹µ ìƒì„±
src/adapters/chat_controller.py # HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬

# ë°ì´í„° ê´€ì‹¬ì‚¬
src/services/history_service.py # íˆìŠ¤í† ë¦¬ CRUD
src/utils/models.py            # ë°ì´í„° ëª¨ë¸

# ì™¸ë¶€ ì—°ë™ ê´€ì‹¬ì‚¬
src/tools/retrieve_knowledge_search.py # Knowledge Base ì—°ë™
```

### 3. **ì˜ì¡´ì„± ë°©í–¥ (Dependency Direction)**
```
High Level (ì •ì±…) â†’ Low Level (êµ¬í˜„)

adapters/ (Controller)
    â†“
services/ (Business Logic)
    â†“
tools/ (External Integration)
    â†“
utils/ (Infrastructure)
```

## ğŸ“Š í˜„ì¬ í”„ë¡œì íŠ¸ ë¶„ì„

### **ì˜ ë¶„ë¦¬ëœ ë¶€ë¶„** âœ…
```
src/
â”œâ”€â”€ adapters/chat_controller.py    # HTTP ì²˜ë¦¬ë§Œ ë‹´ë‹¹
â”œâ”€â”€ services/chat_service.py       # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë§Œ ë‹´ë‹¹
â”œâ”€â”€ services/history_service.py    # íˆìŠ¤í† ë¦¬ ê´€ë¦¬ë§Œ ë‹´ë‹¹
â”œâ”€â”€ tools/retrieve_knowledge_search.py # ì™¸ë¶€ API ì—°ë™ë§Œ ë‹´ë‹¹
â””â”€â”€ utils/models.py                # ë°ì´í„° êµ¬ì¡°ë§Œ ì •ì˜
```

### **ê°œì„  ê°€ëŠ¥í•œ ë¶€ë¶„** âš ï¸
```python
# main.py - ë„ˆë¬´ ë§ì€ ì±…ì„
- FastAPI ì•± ì„¤ì •
- ë¼ìš°í„° ë“±ë¡  
- Guardrail ë¡œì§
- í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (chat ì—”ë“œí¬ì¸íŠ¸)

# ê°œì„  ë°©ì•ˆ
src/
â”œâ”€â”€ app.py                    # FastAPI ì•± ì„¤ì •ë§Œ
â”œâ”€â”€ routers/
â”‚   â”œâ”€â”€ chat_router.py       # ì±„íŒ… ë¼ìš°í„°
â”‚   â””â”€â”€ auth_router.py       # ì¸ì¦ ë¼ìš°í„°
â”œâ”€â”€ middleware/
â”‚   â””â”€â”€ guardrail.py         # Guardrail ë¯¸ë“¤ì›¨ì–´
â””â”€â”€ infrastructure/
    â””â”€â”€ bedrock_client.py    # AWS í´ë¼ì´ì–¸íŠ¸ ê´€ë¦¬
```

## ğŸ¯ ë¶„ë¦¬ ê¸°ì¤€ ê²°ì • ê°€ì´ë“œ

### **1. ë³€ê²½ ë¹ˆë„**
- ìì£¼ ë³€ê²½ë˜ëŠ” ì½”ë“œ â†” ì•ˆì •ì ì¸ ì½”ë“œ ë¶„ë¦¬
- ì˜ˆ: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ â†” ì¸í”„ë¼ ì½”ë“œ

### **2. ì¬ì‚¬ìš©ì„±**
- ì—¬ëŸ¬ ê³³ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì½”ë“œëŠ” ê³µí†µ ëª¨ë“ˆë¡œ ë¶„ë¦¬
- ì˜ˆ: `utils/`, `shared/`

### **3. í…ŒìŠ¤íŠ¸ ìš©ì´ì„±**
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰½ë„ë¡ ì˜ì¡´ì„± ë¶„ë¦¬
- ì˜ˆ: ì™¸ë¶€ API í˜¸ì¶œ ë¶€ë¶„ì„ ë³„ë„ ëª¨ë“ˆë¡œ

### **4. íŒ€ êµ¬ì¡°**
- íŒ€ë³„ ë‹´ë‹¹ ì˜ì—­ì— ë”°ë¥¸ ë¶„ë¦¬
- ì˜ˆ: FrontendíŒ€ â†” BackendíŒ€ â†” AIíŒ€

### **5. ë°°í¬ ë‹¨ìœ„**
- ë…ë¦½ì ìœ¼ë¡œ ë°°í¬ ê°€ëŠ¥í•œ ë‹¨ìœ„ë¡œ ë¶„ë¦¬
- ì˜ˆ: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ êµ¬ì¡°

## ğŸ”„ ë¦¬íŒ©í† ë§ ìš°ì„ ìˆœìœ„

### **Phase 1: ì¦‰ì‹œ ê°œì„ **
```python
# main.py ë¶„ë¦¬
main.py â†’ app.py + routers/ + middleware/
```

### **Phase 2: ì ì§„ì  ê°œì„ **
```python
# ë„ë©”ì¸ë³„ ì¬êµ¬ì„±
src/auth/          # ì¸ì¦ ê´€ë ¨ ëª¨ë“  ì½”ë“œ
src/chat/          # ì±„íŒ… ê´€ë ¨ ëª¨ë“  ì½”ë“œ
src/knowledge/     # ì§€ì‹ ê²€ìƒ‰ ê´€ë ¨ ëª¨ë“  ì½”ë“œ
```

### **Phase 3: ê³ ë„í™”**
```python
# ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë¶„ë¦¬
auth-service/      # ì¸ì¦ ì„œë¹„ìŠ¤
chat-service/      # ì±„íŒ… ì„œë¹„ìŠ¤
knowledge-service/ # ì§€ì‹ ê²€ìƒ‰ ì„œë¹„ìŠ¤
```

## ğŸ“‹ ë¶„ë¦¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ê° ëª¨ë“ˆì´ ë‹¨ì¼ ì±…ì„ì„ ê°€ì§€ëŠ”ê°€?
- [ ] ëª¨ë“ˆ ê°„ ì˜ì¡´ì„±ì´ ëª…í™•í•œê°€?
- [ ] í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰¬ìš´ êµ¬ì¡°ì¸ê°€?
- [ ] ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì½”ë“œê°€ ë¶„ë¦¬ë˜ì–´ ìˆëŠ”ê°€?
- [ ] ë³€ê²½ ì‹œ ì˜í–¥ ë²”ìœ„ê°€ ìµœì†Œí™”ë˜ëŠ”ê°€?